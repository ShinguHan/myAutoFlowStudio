### 1.3 화면 둘러보기

AutoFlow Studio를 처음 실행하면 마주하게 될 화면의 각 부분을 소개합니다.

1. **메인 툴바 (상단):**

   - **대상 앱:** 자동화할 윈도우 창의 제목을 입력하는 곳입니다. (`.*메모장` 처럼 정규식 사용 가능)
   - **앱 연결:** 입력된 제목의 앱을 분석하여 'UI 요소 탐색기'에 표시합니다.
   - **시나리오 제어 버튼:** `반복`, `IF`, `TRY-CATCH` 등 제어 블록을 추가하거나, 시나리오를 저장하고 불러옵니다.

2. **UI 요소 탐색기 (왼쪽 패널):**

   - `앱 연결` 시, 대상 앱의 모든 버튼, 입력창 등이 나무 구조(트리) 형태로 표시됩니다.
   - 여기서 원하는 UI 요소를 마우스로 끌어 '시나리오 편집기'로 가져올 수 있습니다.

3. **시나리오 편집기 (중앙 패널):**

   - 자동화의 흐름이 만들어지는 핵심 공간입니다.
   - UI 요소 탐색기에서 끌어온 항목들이 순서대로 쌓이며, 이 순서대로 자동화가 진행됩니다.
   - 항목을 더블 클릭하거나 마우스 오른쪽 버튼으로 클릭하여 세부 동작(텍스트 입력, 재시도 횟수 등)을 설정할 수 있습니다.

4. **병렬 실행 패널 (오른쪽 패널):**

   - 최대 3개의 시나리오를 동시에 실행하고 관리할 수 있는 공간입니다.
   - 각 슬롯에 시나리오와 테스트 데이터(CSV)를 불러와 독립적으로 실행할 수 있습니다.

5. **로그 뷰어 (하단 왼쪽):**

   - 시나리오가 실행되는 동안 발생하는 모든 과정과 결과가 실시간으로 표시됩니다. 오류 발생 시 원인을 파악하는 데 유용합니다.

6. **로그 모니터 및 트리거 (하단 오른쪽):**

   - 특정 로그 파일의 변화를 감시하다가, 정의된 패턴이 나타나면 지정된 슬롯의 시나리오를 자동으로 실행시키는 고급 기능입니다.

---

## 챕터 2: 핵심 기능 마스터하기

이제 AutoFlow Studio의 강력한 기능들을 예제 시나리오와 함께 하나씩 마스터해 봅시다.

### 2.1 기본 시나리오 만들기 (메모장 글쓰기)

`scenarios/1_notepad_basic.json` 예제를 통해 가장 기본적인 자동화 흐름을 만듭니다.

1. 메모장을 실행합니다.
2. AutoFlow Studio 툴바의 '대상 앱'에 `.*메모장`을 입력하고 `앱 연결` 버튼을 누릅니다.
3. 왼쪽 'UI 요소 탐색기'에 메모장의 구조가 나타나면, `Edit: '텍스트 편집'` 항목을 마우스로 끌어 가운데 '시나리오 편집기'에 놓습니다.
4. 추가된 `▶ CLICK: '텍스트 편집'` 항목을 **더블 클릭**합니다. (7-E 단계에서 이 기능은 `set_text`를 위한 컨텍스트 메뉴로 변경되었으므로, **마우스 오른쪽 클릭 > Set Text Parameters...** 가 더 정확한 표현입니다.) **마우스 오른쪽 클릭 > Set Text Parameters...** 를 선택합니다.
5. 나타나는 입력창에 원하는 메시지를 입력하고 `OK`를 누릅니다.
6. 툴바의 `▶️ (메인) 시나리오 실행` 버튼을 누르면, 메모장에 해당 메시지가 자동으로 입력됩니다!

### 2.2 동적 변수 다루기 (계산기 → 메모장)

`scenarios/2_dynamic_variable_test.json` 예제처럼, 한 앱에서 얻은 정보를 다른 앱에서 활용합니다.

1. 계산기를 실행합니다.
2. 대상 앱을 `.*계산기`로 연결하고, 예제 시나리오를 불러옵니다. 이 시나리오는 `7 * 6`을 계산하고, 그 결과값을 `calcResult`라는 변수에 저장합니다.
3. 툴바의 `▶️ 실행` 버튼을 누릅니다.
4. 시나리오의 마지막 단계에서, 메모장을 대상으로 `{{calcResult}}` 변수를 사용하여 "계산기의 결과는 42 입니다." 라는 문장을 완성합니다.

### 2.3 제어 흐름으로 똑똑한 시나리오 만들기

`scenarios/3_control_flow_test.json` 예제는 `LOOP`와 `IF`를 중첩하여 사용합니다.

- **LOOP:** `🔄 반복 블록 추가` 버튼으로 생성하며, 감싸고 있는 동작들을 지정된 횟수만큼 반복합니다.
- **IF:** `❓ IF 블록 추가` 버튼으로 생성하며, 특정 UI 요소가 '존재하는지' 등의 조건을 확인하여 참일 경우와 거짓일 경우(ELSE)에 각각 다른 행동을 수행하게 합니다.
- **들여쓰기 및 접기/펼치기:** 제어 블록은 시각적으로 들여쓰기 되어 구조 파악이 쉽고, 블록을 접거나 펼쳐 복잡한 시나리오를 간결하게 볼 수 있습니다.

### 2.4 데이터 기반 테스트 (CSV 연동)

`scenarios/4_data_driven_test.json` 예제와 `data/login_data.csv` 파일을 사용합니다.

1. 시나리오의 `set_text` 파라미터를 `User: {{username}}, Status: {{login_status}}` 처럼 CSV 파일의 컬럼명과 동일한 변수로 설정합니다.
2. 오른쪽 '병렬 실행 패널'의 슬롯에서 `Load Data` 버튼을 눌러 `login_data.csv` 파일을 불러옵니다.
3. 시나리오를 실행하면, AutoFlow Studio는 CSV 파일의 **모든 데이터 행(row)을 순회하며** 시나리오를 자동으로 반복 실행합니다.

### 2.5 안정적인 시나리오를 위한 예외 처리

`scenarios/5_error_handling_test.json` 예제는 `TRY-CATCH` 블록을 활용합니다.

- **TRY:** 이 블록 안에 예기치 않은 오류가 발생할 수 있는 동작(예: 가끔 나타나는 팝업창 닫기)을 넣습니다.
- **CATCH:** `TRY` 블록에서 오류가 발생했을 경우에만 이 블록 안의 동작(예: 오류 로그 기록, 복구 절차 수행)이 실행됩니다. 오류가 없다면 이 블록은 건너뜁니다.
- 이를 통해, 예측 가능한 오류가 전체 자동화를 중단시키는 것을 방지하고 시나리오의 안정성을 크게 높일 수 있습니다.

---

## 챕터 3: 고급 활용 및 팁

이 챕터에서는 AutoFlow Studio를 더욱 전문적으로 사용하는 방법을 다룹니다.

### 3.1 병렬 실행으로 테스트 시간 단축하기

'병렬 실행 패널'의 3개 슬롯에 각각 다른 시나리오와 데이터 파일을 로드하여 동시에 실행할 수 있습니다. 수십 개의 회귀 테스트 케이스를 3개의 그룹으로 나누어 동시에 실행하면, 전체 테스트 시간을 1/3로 단축시킬 수 있습니다.

### 3.2 로그 트리거로 자동화의 자동화 구현하기

'로그 모니터 및 트리거' 패널을 사용하여 특정 조건이 만족되었을 때 다른 자동화를 연쇄적으로 실행할 수 있습니다.

- **활용 예시:**
  - **파일 감시:** 다운로드 폴더의 로그를 감시하다가, 파일 다운로드가 완료되었다는 로그가 찍히면, 해당 파일을 열어 데이터를 처리하는 시나리오를 자동으로 실행합니다.
  - **CI/CD 연동:** 빌드 서버의 로그를 감시하다가, 'Build Succeeded' 메시지가 나타나면, 방금 빌드된 프로그램을 대상으로 회귀 테스트 시나리오를 자동으로 실행합니다.

### 3.3 문제 해결 (Troubleshooting)

- **앱 연결이 안 돼요:**
  - 대상 앱이 정말 실행 중인지 확인하세요.
  - '대상 앱' 입력란의 창 제목이 정확한지, 오타는 없는지 확인하세요. 일부만 일치시켜도 되는 `.*` (정규식)을 활용해 보세요. (예: `.*메모장`)
- **UI 요소를 찾지 못해요 (TimeoutError):**
  - 자동화 대상 앱의 버전이 업데이트되어 UI 요소의 이름이나 구조가 바뀌었을 수 있습니다. `앱 연결`을 다시 하여 최신 구조를 반영하세요.
  - 동작이 너무 빨라 앱이 반응하기 전에 다음 단계로 넘어갔을 수 있습니다. 문제가 되는 동작 앞에 `⏱️ 대기 추가` 블록을 넣어, 해당 요소가 나타날 때까지 기다리도록 만드세요.
